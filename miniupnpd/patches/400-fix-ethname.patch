--- a/miniupnpd.c
+++ b/miniupnpd.c
@@ -934,7 +934,16 @@ parselanaddr(struct lan_addr_s * lan_add
 	while(*p && *p != '/' && !isspace(*p))
 		p++;
 	n = p - str;
-	if(!isdigit(str[0]) && n < (int)sizeof(lan_addr->ifname))
+
+	int looks_like_ipv4 = 1, dots = 0;
+	for (unsigned int i = 0; i < n; i++) {
+		unsigned char c = (unsigned char)str[i];
+		if (c == '.') dots++;
+		else if (!isdigit(c)) { looks_like_ipv4 = 0; break; }
+	}
+	looks_like_ipv4 = looks_like_ipv4 && (dots == 3);
+
+	if (!looks_like_ipv4 && n < (int)sizeof(lan_addr->ifname))
 	{
 		/* not starting with a digit : suppose it is an interface name */
 		memcpy(lan_addr->ifname, str, n);
